# 8255A 并行接口

３个端口　２４个外设引脚

三种输入输出工作方式

![image-20210703103411707](8255A.assets/image-20210703103411707.png)

与处理器接口

| CS*   A1   A0 | I/O地址 | RD*     | WR*      |
| :-----------: | ------- | ------- | -------- |
|   0   0   0   | 60H     | Read PA | Write PA |
|   0   0   1   | 61H     | Read PB | Write PB |
|   0   1   0   | 62H     | Read PC | Write PC |
|   0   1   1   | 63H     | 非法    | 写控制字 |

## 端口Ａ

PA0-7 支持工作方式０　１　２

常作数据端口

### 引脚

#### 方式1

>   借用C口做联络信号
>
>   具有中断请求和屏蔽功能

##### 输入

| A口引脚 | 外设引脚 | 信号位           | 含义                |
| ------- | -------- | ---------------- | ------------------- |
| **PC4** | STB*     | 数据选通信号     | 表示外设准备好数据  |
| PC5     | IBF      | 输入缓冲器满信号 | 表示A口已经接收数据 |
| PC3     | INTR     | 中断请求信号     | 请求CPU接收数据     |

| B口引脚 | 外设引脚 | 信号位           | 含义                |
| ------- | -------- | ---------------- | ------------------- |
| **PC2** | STB*     | 数据选通信号     | 表示外设准备好数据  |
| PC1     | IBF      | 输入缓冲器满信号 | 表示A口已经接收数据 |
| PC0     | INTR     | 中断请求信号     | 请求CPU接收数据     |

![image-20210703105749598](8255A.assets/image-20210703105749598.png)

`INTR=INTR&IBF`

STB*和IBF是外设和8255A的应答联络信号

##### 输出

![image-20210703110154875](8255A.assets/image-20210703110154875.png)

| A口引脚 | 外设引脚 | 信号位           | 含义                   |
| ------- | -------- | ---------------- | ---------------------- |
| **PC6** | ACK*     | 外设响应信号     | 表示外设已经接受到数据 |
| PC7     | OBF*     | 输出缓冲器满信号 | 表示CPU已经输出数据    |
| PC3     | INTR     | 中断请求信号     | 请求CPU再次输出数据    |

ACK\*和OBF\*是外设和8255A的应答联络信号

#### 方式2

组合方式1的选通输入输出

>   在外设响应ACK*才送出数据



## 端口Ｂ

PB0-7 支持工作方式０　１

常作数据端口

## 端口Ｃ

支持工作方式０

A组控制高4位　PC4-7

B组控制低4位　PC0-3

-   可作**数据**、**状态**和**控制**端口
-   分两个4位，每位可独立操作
-   控制最灵活，最难掌握



C 端口分为**两个4位端口**

-   只能方式0
-   可分别选择输入输出



对C口数据输出

-   通过端口C I/O地址:直接写入字节数据
-   通过控制端口:写入位控字
    -   D7 为 0
    -   D3-1 为位选择
    -   D0 为 位设置

被AB口征用为联络线引脚可以读到8255A的**状态字**

![image-20210703114153790](8255A.assets/image-20210703114153790.png)

## 工作方式

方式

0.  基本输入输出方式
    1.  适用于无条件传送和查询方式的接口电路
1.  选通输入输出方式
    1.  适用于查询和中断方式的接口电路
2.  双向选通传送方式
    1.  适用于与双向传送数据的外设
    2.  适用于查询和中断方式的接口电路

>   输入数据缓冲
>
>   输出数据锁存

## 编程

初始化:一个方式控制字

```asm
MOV AL,10011001B;99H
OUT 63H,AL
```



![image-20210703111012058](8255A.assets/image-20210703111012058.png)

利用8255A的输出锁存能力，可实现按位输出控制

```asm
mov dx,0fffah	;B端口假设为FFFAH
in al,dx	;读出B端口原输出内容
or al,80h	;使PB7＝1
out dx,al	;输出新的内容
```



8255A具有锁存输出数据的能力

-   对输出方式的端口同样可以输入
-   不是读取外设数据
-   读取的是上次CPU给外设的数据

